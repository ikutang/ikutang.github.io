<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="baidu-site-verification" content="codeva-OBV0UPgBod" />
    <meta name="msvalidate.01" content="B9019CE3751A15D63E78AF8679980069" />
    <meta name="description" content="Docker å­¦ä¹ ç¬”è®°Docker æ˜¯ä¸€ä¸ªä¸ºå¼€å‘ã€åˆ†å‘ã€è¿è¡Œåº”ç”¨ç¨‹åºè€Œç”Ÿçš„å¼€æ”¾å¹³å°ï¼ŒDocker å¯ä»¥è®©æˆ‘ä»¬å°†åŸºç¡€ç¯å¢ƒå’Œåº”ç”¨ç¨‹åºåˆ†ç¦»å¼€æ¥ï¼Œä»¥ä¾¿å¯ä»¥å¿«é€Ÿäº¤ä»˜è½¯ä»¶ã€‚æœ‰äº† Dockerï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç®¡ç†è½¯ä»¶çš„åŒæ—¶ç®¡ç†åŸºç¡€ç¯å¢ƒã€‚åŸºäº Docker åˆ†å‘ã€æµ‹è¯•ã€éƒ¨ç½²çš„æ–¹æ³•è®ºï¼Œå¯ä»¥æå¤§çš„é™ä½ç¼–ç ä¸äº¤ä»˜è¿è¡Œä¹‹é—´çš„å»¶è¿Ÿã€‚ ä½¿ç”¨ Docker å¯ä»¥å¾ˆè½»æ¾çš„ä¿è¯ç¨‹åºè¿è¡Œç¯å¢ƒçš„ä¸€è‡´æ€§ï¼Œå‡å°‘å› ç¯å¢ƒä¸ä¸€è‡´å¯¼è‡´çš„å„ç§é—®é¢˜ã€‚å„ä¸ª">
<meta property="og:type" content="article">
<meta property="og:title" content="Dockerå­¦ä¹ ç¬”è®°">
<meta property="og:url" content="https://lozhu.happy365.day/2023/09/02/5157cf948645/index.html">
<meta property="og:site_name" content="Lozhu&#39;s blog">
<meta property="og:description" content="Docker å­¦ä¹ ç¬”è®°Docker æ˜¯ä¸€ä¸ªä¸ºå¼€å‘ã€åˆ†å‘ã€è¿è¡Œåº”ç”¨ç¨‹åºè€Œç”Ÿçš„å¼€æ”¾å¹³å°ï¼ŒDocker å¯ä»¥è®©æˆ‘ä»¬å°†åŸºç¡€ç¯å¢ƒå’Œåº”ç”¨ç¨‹åºåˆ†ç¦»å¼€æ¥ï¼Œä»¥ä¾¿å¯ä»¥å¿«é€Ÿäº¤ä»˜è½¯ä»¶ã€‚æœ‰äº† Dockerï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç®¡ç†è½¯ä»¶çš„åŒæ—¶ç®¡ç†åŸºç¡€ç¯å¢ƒã€‚åŸºäº Docker åˆ†å‘ã€æµ‹è¯•ã€éƒ¨ç½²çš„æ–¹æ³•è®ºï¼Œå¯ä»¥æå¤§çš„é™ä½ç¼–ç ä¸äº¤ä»˜è¿è¡Œä¹‹é—´çš„å»¶è¿Ÿã€‚ ä½¿ç”¨ Docker å¯ä»¥å¾ˆè½»æ¾çš„ä¿è¯ç¨‹åºè¿è¡Œç¯å¢ƒçš„ä¸€è‡´æ€§ï¼Œå‡å°‘å› ç¯å¢ƒä¸ä¸€è‡´å¯¼è‡´çš„å„ç§é—®é¢˜ã€‚å„ä¸ª">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-09-02T04:14:51.000Z">
<meta property="article:modified_time" content="2024-12-08T06:50:57.167Z">
<meta property="article:author" content="lozhu">
<meta property="article:tag" content="Docker">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Dockerå­¦ä¹ ç¬”è®°</title>
    <!-- async scripts -->
    <!-- Google Analytics -->

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XMGS491MQF"></script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-XMGS491MQF');
  </script>


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Lozhu's blog" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="modal" class="modal">
  <span id="modal_close_btn" class="modal-close-btn">x</span>
  <img id="modal_image" class="modal-image">
  <!-- <div id="caption"></div> -->
</div>

      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="ç›®å½•"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="ç›®å½•"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="é¡¶éƒ¨" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">é¦–é¡µ</a></li><!--
     --><!--
       --><li><a href="/archives/">å½’æ¡£</a></li><!--
     --><!--
       --><li><a href="/friends/">å‹é“¾</a></li><!--
     --><!--
       --><li><a href="/about/">å…³äº</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://www.travellings.cn/go.html">å¼€å¾€ ğŸš‡</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="ä¸Šä¸€ç¯‡" href="/2023/09/02/2208f957f610/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="ä¸‹ä¸€ç¯‡" href="/2023/09/01/832a97d93df3/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="è¿”å›é¡¶éƒ¨" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="åˆ†äº«æ–‡ç« " href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">ä¸Šä¸€ç¯‡</span>
      <span id="i-next" class="info" style="display:none;">ä¸‹ä¸€ç¯‡</span>
      <span id="i-top" class="info" style="display:none;">è¿”å›é¡¶éƒ¨</span>
      <span id="i-share" class="info" style="display:none;">åˆ†äº«æ–‡ç« </span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://lozhu.happy365.day/2023/09/02/5157cf948645/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li> -->
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://lozhu.happy365.day/2023/09/02/5157cf948645/&text=Dockerå­¦ä¹ ç¬”è®°"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://lozhu.happy365.day/2023/09/02/5157cf948645/&title=Dockerå­¦ä¹ ç¬”è®°"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://lozhu.happy365.day/2023/09/02/5157cf948645/&is_video=false&description=Dockerå­¦ä¹ ç¬”è®°"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li> -->
  <li><a class="icon" href="mailto:?subject=Dockerå­¦ä¹ ç¬”è®°&body=Check out this article: https://lozhu.happy365.day/2023/09/02/5157cf948645/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://lozhu.happy365.day/2023/09/02/5157cf948645/&title=Dockerå­¦ä¹ ç¬”è®°"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://lozhu.happy365.day/2023/09/02/5157cf948645/&title=Dockerå­¦ä¹ ç¬”è®°"><i class="fab fa-reddit " aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://lozhu.happy365.day/2023/09/02/5157cf948645/&title=Dockerå­¦ä¹ ç¬”è®°"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://lozhu.happy365.day/2023/09/02/5157cf948645/&title=Dockerå­¦ä¹ ç¬”è®°"><i class="fab fa-digg " aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://lozhu.happy365.day/2023/09/02/5157cf948645/&name=Dockerå­¦ä¹ ç¬”è®°&description=&lt;h2 id=&#34;Docker-å­¦ä¹ ç¬”è®°&#34;&gt;&lt;a href=&#34;#Docker-å­¦ä¹ ç¬”è®°&#34; class=&#34;headerlink&#34; title=&#34;Docker å­¦ä¹ ç¬”è®°&#34;&gt;&lt;/a&gt;Docker å­¦ä¹ ç¬”è®°&lt;/h2&gt;&lt;p&gt;Docker æ˜¯ä¸€ä¸ªä¸ºå¼€å‘ã€åˆ†å‘ã€è¿è¡Œåº”ç”¨ç¨‹åºè€Œç”Ÿçš„å¼€æ”¾å¹³å°ï¼ŒDocker å¯ä»¥è®©æˆ‘ä»¬å°†åŸºç¡€ç¯å¢ƒå’Œåº”ç”¨ç¨‹åºåˆ†ç¦»å¼€æ¥ï¼Œä»¥ä¾¿å¯ä»¥å¿«é€Ÿäº¤ä»˜è½¯ä»¶ã€‚æœ‰äº† Dockerï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç®¡ç†è½¯ä»¶çš„åŒæ—¶ç®¡ç†åŸºç¡€ç¯å¢ƒã€‚åŸºäº Docker åˆ†å‘ã€æµ‹è¯•ã€éƒ¨ç½²çš„æ–¹æ³•è®ºï¼Œå¯ä»¥æå¤§çš„é™ä½ç¼–ç ä¸äº¤ä»˜è¿è¡Œä¹‹é—´çš„å»¶è¿Ÿã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ Docker å¯ä»¥å¾ˆè½»æ¾çš„ä¿è¯ç¨‹åºè¿è¡Œç¯å¢ƒçš„ä¸€è‡´æ€§ï¼Œå‡å°‘å› ç¯å¢ƒä¸ä¸€è‡´å¯¼è‡´çš„å„ç§é—®é¢˜ã€‚å„ä¸ª Docker å®¹å™¨ä¹‹é—´ç›¸äº’éš”ç¦»ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªå®¿ä¸»æœºä¸Šè¿è¡Œå¤šä¸ªå®¹å™¨ï¼Œå„ä¸ªå®¹å™¨éƒ½åŒ…å«äº†åº”ç”¨ç¨‹åºéœ€è¦çš„æ‰€æœ‰èµ„æºï¼Œå¯ä»¥å¾ˆè½»æ¾çš„ä¿è¯åŒä¸€ä¸ªå®¹å™¨åœ¨æ¯ä¸ªåœ°æ–¹è¿è¡Œçš„ç»“æœéƒ½ä¸€è‡´ã€‚&lt;/p&gt;"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://lozhu.happy365.day/2023/09/02/5157cf948645/&t=Dockerå­¦ä¹ ç¬”è®°"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li> -->
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0"><span class="toc-number">1.</span> <span class="toc-text">Docker å­¦ä¹ ç¬”è®°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Debian12-%E5%AE%89%E8%A3%85-Docker"><span class="toc-number">2.</span> <span class="toc-text">Debian12 å®‰è£… Docker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dockerfile-%E7%94%9F%E6%88%90%E9%95%9C%E5%83%8F"><span class="toc-number">3.</span> <span class="toc-text">Dockerfile ç”Ÿæˆé•œåƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-Hub-%E5%85%B1%E4%BA%AB%E9%95%9C%E5%83%8F"><span class="toc-number">4.</span> <span class="toc-text">Docker Hub å…±äº«é•œåƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DB-%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-number">5.</span> <span class="toc-text">DB æŒä¹…åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#volume-%E6%8C%81%E4%B9%85%E5%8C%96%E6%95%B0%E6%8D%AE"><span class="toc-number">5.1.</span> <span class="toc-text">volume æŒä¹…åŒ–æ•°æ®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bind-%E6%8C%81%E4%B9%85%E5%8C%96%E6%95%B0%E6%8D%AE"><span class="toc-number">5.2.</span> <span class="toc-text">bind æŒä¹…åŒ–æ•°æ®</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E5%AE%B9%E5%99%A8%E5%BA%94%E7%94%A8"><span class="toc-number">6.</span> <span class="toc-text">å¤šå®¹å™¨åº”ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-%E6%9F%A5%E7%9C%8B-%E5%88%A0%E9%99%A4-Docker-%E7%BD%91%E7%BB%9C"><span class="toc-number">6.1.</span> <span class="toc-text">åˆ›å»º&#x2F;æŸ¥çœ‹&#x2F;åˆ é™¤ Docker ç½‘ç»œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nicolaka-netshoot"><span class="toc-number">6.2.</span> <span class="toc-text">nicolaka&#x2F;netshoot</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-compose"><span class="toc-number">6.3.</span> <span class="toc-text">Docker compose</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%95%9C%E5%83%8F%E6%9E%84%E5%BB%BA%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">7.</span> <span class="toc-text">é•œåƒæ„å»ºæœ€ä½³å®è·µ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AA%E5%83%8F%E9%95%9C%E5%83%8F%E4%B8%AD%E5%A4%8D%E5%88%B6%E5%BF%85%E8%A6%81%E7%9A%84%E6%96%87%E4%BB%B6%E6%9C%89%E5%8A%A9%E4%BA%8E%E7%BC%A9%E5%B0%8F%E9%95%9C%E5%83%8F%E7%9A%84%E5%A4%A7%E5%B0%8F"><span class="toc-number">7.1.</span> <span class="toc-text">åªåƒé•œåƒä¸­å¤åˆ¶å¿…è¦çš„æ–‡ä»¶æœ‰åŠ©äºç¼©å°é•œåƒçš„å¤§å°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Multi-stage-builds"><span class="toc-number">7.2.</span> <span class="toc-text">Multi-stage builds</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E5%AE%9A%E5%9C%BA%E6%99%AF%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">8.</span> <span class="toc-text">ç‰¹å®šåœºæ™¯æœ€ä½³å®è·µ</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        Dockerå­¦ä¹ ç¬”è®°
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">lozhu</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-09-02T04:14:51.000Z" class="dt-published" itemprop="datePublished">2023-09-02</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">å­¦ä¹ ç¬”è®°</a>
    </div>


      
    <!-- <div class="article-tag"> -->
    <div class="article-category">
        <i class="fa-solid fa-tag"></i>
        <!-- <a class="p-category" href="/tags/Docker/" rel="tag">Docker</a> -->
        <a class="category-link" href="/tags/Docker/" rel="tag">Docker</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Docker-å­¦ä¹ ç¬”è®°"><a href="#Docker-å­¦ä¹ ç¬”è®°" class="headerlink" title="Docker å­¦ä¹ ç¬”è®°"></a>Docker å­¦ä¹ ç¬”è®°</h2><p>Docker æ˜¯ä¸€ä¸ªä¸ºå¼€å‘ã€åˆ†å‘ã€è¿è¡Œåº”ç”¨ç¨‹åºè€Œç”Ÿçš„å¼€æ”¾å¹³å°ï¼ŒDocker å¯ä»¥è®©æˆ‘ä»¬å°†åŸºç¡€ç¯å¢ƒå’Œåº”ç”¨ç¨‹åºåˆ†ç¦»å¼€æ¥ï¼Œä»¥ä¾¿å¯ä»¥å¿«é€Ÿäº¤ä»˜è½¯ä»¶ã€‚æœ‰äº† Dockerï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç®¡ç†è½¯ä»¶çš„åŒæ—¶ç®¡ç†åŸºç¡€ç¯å¢ƒã€‚åŸºäº Docker åˆ†å‘ã€æµ‹è¯•ã€éƒ¨ç½²çš„æ–¹æ³•è®ºï¼Œå¯ä»¥æå¤§çš„é™ä½ç¼–ç ä¸äº¤ä»˜è¿è¡Œä¹‹é—´çš„å»¶è¿Ÿã€‚</p>
<p>ä½¿ç”¨ Docker å¯ä»¥å¾ˆè½»æ¾çš„ä¿è¯ç¨‹åºè¿è¡Œç¯å¢ƒçš„ä¸€è‡´æ€§ï¼Œå‡å°‘å› ç¯å¢ƒä¸ä¸€è‡´å¯¼è‡´çš„å„ç§é—®é¢˜ã€‚å„ä¸ª Docker å®¹å™¨ä¹‹é—´ç›¸äº’éš”ç¦»ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªå®¿ä¸»æœºä¸Šè¿è¡Œå¤šä¸ªå®¹å™¨ï¼Œå„ä¸ªå®¹å™¨éƒ½åŒ…å«äº†åº”ç”¨ç¨‹åºéœ€è¦çš„æ‰€æœ‰èµ„æºï¼Œå¯ä»¥å¾ˆè½»æ¾çš„ä¿è¯åŒä¸€ä¸ªå®¹å™¨åœ¨æ¯ä¸ªåœ°æ–¹è¿è¡Œçš„ç»“æœéƒ½ä¸€è‡´ã€‚</p>
<span id="more"></span>



<h2 id="Debian12-å®‰è£…-Docker"><a href="#Debian12-å®‰è£…-Docker" class="headerlink" title="Debian12 å®‰è£… Docker"></a>Debian12 å®‰è£… Docker</h2><p>å¸è½½æ—§ç‰ˆæœ¬</p>
<pre><code class="sh">sudo apt remove docker docker-engine docker.io
</code></pre>
<p>å®‰è£… gpg å¹¶æ·»åŠ  gpg å¯†é’¥</p>
<pre><code class="sh">sudo apt install gnupg
curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/debian/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg
</code></pre>
<p>æ·»åŠ è½¯ä»¶æºå¹¶æ›´æ–°</p>
<pre><code class="sh">echo &quot;deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/debian $(lsb_release -cs) stable&quot; | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
sudo apt update
</code></pre>
<p>å®‰è£…</p>
<pre><code class="sh">sudo apt install docker-ce docker-ce-cli containerd.io docker-compose-plugin
</code></pre>
<p>è®¾ç½®å¼€æœºè‡ªå¯åŠ¨å¹¶å¯åŠ¨</p>
<pre><code class="sh">sudo systemctl enable docker
sudo systemctl start docker
</code></pre>
<p>éªŒè¯</p>
<pre><code class="sh">sudo docker run --rm hello-world
</code></pre>
<p>è¾“å‡ºä¸‹é¢çš„å†…å®¹åˆ™è¡¨ç¤ºå®‰è£…æˆåŠŸ</p>
<pre><code>Unable to find image &#39;hello-world:latest&#39; locally
latest: Pulling from library/hello-world
719385e32844: Pull complete
Digest: sha256:dcba6daec718f547568c562956fa47e1b03673dd010fe6ee58ca806767031d1c
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.
    (amd64)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/get-started/
</code></pre>
<p>ä½¿ç”¨å›½å†… docker é•œåƒæºï¼Œåˆ›å»º &#x2F;etc&#x2F;daemon.json æ–‡ä»¶å¹¶å†™å…¥ä¸‹é¢çš„å†…å®¹ï¼š</p>
<pre><code class="json">&#123;
   &quot;registry-mirrors&quot;: [
   &quot;https://mirror.ccs.tencentyun.com&quot;
  ]
&#125;
</code></pre>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://docker-practice.github.io/zh-cn/install/debian.html#">Debian å®‰è£… Docker</a></p>
<h2 id="Dockerfile-ç”Ÿæˆé•œåƒ"><a href="#Dockerfile-ç”Ÿæˆé•œåƒ" class="headerlink" title="Dockerfile ç”Ÿæˆé•œåƒ"></a>Dockerfile ç”Ÿæˆé•œåƒ</h2><p>Docker å…¥é—¨æ–‡æ¡£ä¸­çš„ Dockerfileï¼š</p>
<pre><code class="dockerfile"># syntax=docker/dockerfile:1

FROM node:18-alpine # æ„å»ºé•œåƒæ—¶ä½¿ç”¨çš„åŸºç¡€é•œåƒ
WORKDIR /app
COPY . . # å¤åˆ¶å½“å‰è·¯å¾„ä¸‹çš„æ–‡ä»¶åˆ° WORKDIR
RUN yarn install --production
CMD [&quot;node&quot;, &quot;src/index.js&quot;] # ä»é•œåƒå¯åŠ¨å®¹å™¨æ—¶é»˜è®¤æ‰§è¡Œçš„å‘½ä»¤
EXPOSE 3000
</code></pre>
<p>é•œåƒæ„å»ºå‘½ä»¤ï¼š</p>
<pre><code class="sh"># . ä»£è¡¨ Dockerfile æ–‡ä»¶æ‰€åœ¨è·¯å¾„
# -t æ„å»ºå‡ºæ¥çš„é•œåƒçš„å¯è¯»åç§°
docker build -t getting-started .
</code></pre>
<p>ä»é•œåƒå¯åŠ¨å®¹å™¨ï¼š</p>
<pre><code class="sh"># -d åå°è¿è¡Œ
# -p æŒ‡å®šå®¹å™¨ç«¯å£ä¸å®¿ä¸»æœºç«¯å£çš„æ˜ å°„ï¼Œå®¿ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£
docker run -dp 3000:3000 getting-started
</code></pre>
<p>æŸ¥çœ‹å®¹å™¨çš„æ—¥å¿—ï¼š</p>
<pre><code class="sh">docker logs &lt;container id&gt;
</code></pre>
<p>æŸ¥çœ‹æ‰€æœ‰çš„é•œåƒï¼š</p>
<pre><code class="sh">docker image ls
docker images
</code></pre>
<p>æŸ¥çœ‹æ‰€æœ‰çš„å®¹å™¨ï¼š</p>
<pre><code class="sh">docker ps -a
</code></pre>
<p>åœæ­¢å®¹å™¨ï¼š</p>
<pre><code class="sh">docker stop &lt;container-id-1&gt; &lt;container-id-2&gt;
</code></pre>
<p>åˆ é™¤å®¹å™¨ï¼š</p>
<pre><code class="sh">docker rm [-f] &lt;container-id-1&gt; &lt;container-id-2&gt;
</code></pre>
<h2 id="Docker-Hub-å…±äº«é•œåƒ"><a href="#Docker-Hub-å…±äº«é•œåƒ" class="headerlink" title="Docker Hub å…±äº«é•œåƒ"></a>Docker Hub å…±äº«é•œåƒ</h2><p>Docker Hub æ˜¯ä¸€ä¸ª Docker é•œåƒä»“åº“ï¼Œå¯ä»¥é€šè¿‡ Docker Hubæ³¨å†Œ Docker è´¦å·ï¼š<a target="_blank" rel="noopener" href="https://hub.docker.com/">docker hub</a>ï¼Œè·å– Docker ID å¹¶åˆ›å»º Docker Repositoryï¼ˆPublic ç±»å‹ï¼‰ åå°†è‡ªå·±ç”Ÿæˆçš„é•œåƒæ¨é€åˆ° Docker Hub ä»è€Œä¸ä»–äººå…±äº«é•œåƒã€‚</p>
<p>CLI ç™»é™† Docker Hubï¼š</p>
<pre><code class="sh">docker login -u &lt;docker id&gt;
</code></pre>
<p>ç”Ÿæˆé•œåƒï¼š</p>
<pre><code class="sh">docker build -t &lt;docker id&gt;/&lt;image name&gt;:[tag name] .
</code></pre>
<p>å°†é•œåƒæ¨é€åˆ° Docker Hubï¼š</p>
<pre><code class="sh"># docker push &lt;docker id&gt;/&lt;image-name&gt;:[tag name]
docker push chenxii81/getting-started:v1.1.0
</code></pre>
<p>é—®é¢˜è®°å½•ï¼š</p>
<pre><code>The push refers to repository [docker.io/library/getting-started]
cdc22a9416c1: Preparing
1455e46f1ebf: Preparing
b81bc62fafca: Preparing
885a5d40fc11: Preparing
1b6c3782871e: Preparing
b0e46d71a47b: Waiting
f1417ff83b31: Waiting
denied: requested access to the resource is denied
</code></pre>
<blockquote>
<p>å› ä¸º build image çš„æ—¶å€™é•œåƒåæœªæ·»åŠ  docker idã€‚å‚è€ƒï¼š <a target="_blank" rel="noopener" href="https://qiita.com/shundayo/items/4ae35930fe9f85f535b0">ã€å‚™å¿˜éŒ²ã€‘docker pushã—ãŸã‚‰æ‹’å¦ã•ã‚ŒãŸ</a></p>
</blockquote>
<p>è¿è¡Œå®¹å™¨ï¼š</p>
<pre><code class="sh">docker run -dp 0.0.0.0:3000:3000 &lt;docker id&gt;/getting-started
</code></pre>
<p>æ˜ å°„åˆ° 0.0.0.0:3000 å¯ä»¥ä»å¤–éƒ¨ç½‘ç»œè®¿é—®ï¼Œå¦‚æœå†™æˆ <code>-p 3000:3000</code> ä¹Ÿæ˜¯ç›¸åŒçš„æ•ˆæœã€‚</p>
<p>è®¿é—®ï¼š<a target="_blank" rel="noopener" href="http://localhost:3000/">http://localhost:3000</a> å¯ä»¥çœ‹åˆ° todo list.</p>
<h2 id="DB-æŒä¹…åŒ–"><a href="#DB-æŒä¹…åŒ–" class="headerlink" title="DB æŒä¹…åŒ–"></a>DB æŒä¹…åŒ–</h2><h3 id="volume-æŒä¹…åŒ–æ•°æ®"><a href="#volume-æŒä¹…åŒ–æ•°æ®" class="headerlink" title="volume æŒä¹…åŒ–æ•°æ®"></a>volume æŒä¹…åŒ–æ•°æ®</h3><p>åœ¨ä¸€ä¸ªå®¹å™¨ä¸­åˆ›å»º&#x2F;æ›´æ–°&#x2F;åˆ é™¤çš„æ–‡ä»¶ï¼Œå¯¹äºä»åŒä¸€ä¸ªé•œåƒæ¥çš„å®¹å™¨æ˜¯ä¸å¯è§çš„ã€‚Volumes å¯ä»¥å®ç°å°†å®¿ä¸»æœºæ–‡ä»¶ç³»ç»Ÿå’Œå®¹å™¨æ–‡ä»¶ç³»ç»Ÿçš„å…³è”ï¼Œå®¹å™¨å¯¹æŒ‚è½½çš„æ–‡ä»¶æ‰€åšçš„æ“ä½œä¼šä¿å­˜åœ¨å®¿ä¸»æœºæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå¦‚æœå°†å®¿ä¸»æœºæ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ°å¤šä¸ªå®¹å™¨ï¼Œé‚£ä¹ˆå„ä¸ªå®¹å™¨å¯ä»¥çœ‹åˆ°ç›¸åŒçš„æ•°æ®ã€‚</p>
<pre><code class="sh">docker volume create &lt;volume name&gt;
</code></pre>
<p>æŸ¥çœ‹å·ï¼š</p>
<pre><code class="sh">docker volume ls
</code></pre>
<p>æŸ¥çœ‹å·è¯¦ç»†ä¿¡æ¯ï¼š</p>
<pre><code class="sh">docker volume inspect &lt;volume name&gt;
</code></pre>
<p>åˆ é™¤å·ï¼š</p>
<pre><code class="sh">docker volume rm &lt;volume name&gt;
</code></pre>
<p>å¯åŠ¨å®¹å™¨æ—¶ä½¿ç”¨ <code>--mount</code> æŒ‡å®šæŒ‚è½½çš„å·ï¼š</p>
<pre><code class="sh">docker run -dp 0.0.0.0:3000:3000 --mount type=volume,src=todo-db,target=/etc/todos chenxii81/getting-started
</code></pre>
<ul>
<li>type: volume</li>
<li>src: volume name</li>
<li>target: æŒ‚è½½åˆ°å®¹å™¨çš„ä½ç½®</li>
</ul>
<p>æŸ¥çœ‹ volume ä¸­çš„æ•°æ®å­˜å‚¨ä½ç½®ï¼š</p>
<pre><code class="sh">docker volume inspect &lt;volume name&gt;
</code></pre>
<pre><code class="json">[
    &#123;
        &quot;CreatedAt&quot;: &quot;2023-09-02T11:29:50+08:00&quot;,
        &quot;Driver&quot;: &quot;local&quot;,
        &quot;Labels&quot;: &#123;&#125;,
        &quot;Mountpoint&quot;: &quot;/var/lib/docker/volumes/todo-db/_data&quot;,  // æ•°æ®å­˜å‚¨ä½ç½®
        &quot;Name&quot;: &quot;todo-db&quot;,
        &quot;Options&quot;: &#123;&#125;,
        &quot;Scope&quot;: &quot;local&quot;
    &#125;
]
</code></pre>
<p><strong>å¦‚æœ volume ä¸ºç©ºï¼Œdocker ä¼šå°†å®¹å™¨ä¸­çš„æ–‡ä»¶æ‹·è´è‡³ volumeï¼Œå¦‚æœ volumeä¸ä¸ºç©ºï¼Œåˆ™å°† volume ä¸­çš„å†…å®¹æ‹·è´è‡³å®¹å™¨ä¸­ã€‚</strong></p>
<h3 id="bind-æŒä¹…åŒ–æ•°æ®"><a href="#bind-æŒä¹…åŒ–æ•°æ®" class="headerlink" title="bind æŒä¹…åŒ–æ•°æ®"></a>bind æŒä¹…åŒ–æ•°æ®</h3><p>bind æŒ‚è½½æ˜¯é™¤ volume ä¹‹å¤–å°†å®¿ä¸»æœºæ–‡ä»¶ç³»ç»Ÿå…±äº«åˆ°å®¹å™¨çš„å¦ä¸€ç§æ–¹å¼ã€‚</p>
<p><strong>å¦‚æœå®¿ä¸»æœºä¸­ä¸ºç©ºï¼Œåˆ™ä¼šæ¸…ç©ºå®¹å™¨ä¸­çš„ç›®å½•ã€‚å¦‚æœå®¿ä¸»æœºæœ‰æ–‡ä»¶ï¼Œä¸è¦ä½¿ç”¨ bindï¼Œå®¹å™¨ç›®å½•ä¼šè¢«æ¸…ç©ºã€‚</strong></p>
<p>bind å’Œ volume çš„åŒºåˆ«ï¼š</p>
<table>
<thead>
<tr>
<th></th>
<th>Named volumes</th>
<th>Bind mounts</th>
</tr>
</thead>
<tbody><tr>
<td>Host location</td>
<td>Docker chooses</td>
<td>You decide</td>
</tr>
<tr>
<td>Mount example (using <code>--mount</code>)</td>
<td>type&#x3D;volume,src&#x3D;my-volume,target&#x3D;&#x2F;usr&#x2F;local&#x2F;data</td>
<td>type&#x3D;bind,src&#x3D;&#x2F;path&#x2F;to&#x2F;data,target&#x3D;&#x2F;usr&#x2F;local&#x2F;data</td>
</tr>
<tr>
<td>Populates new volume with container contents</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td>Supports Volume Drivers</td>
<td>Yes</td>
<td>No</td>
</tr>
</tbody></table>
<p>bind ä½¿ç”¨ï¼š</p>
<pre><code class="sh">docker run -it --mount type=bind,src=&quot;$(pwd)&quot;,target=/src/getting-started ubuntu bash
</code></pre>
<p>åœ¨å®¿ä¸»æœºç›®å½•ä¸­åˆ›å»º&#x2F;åˆ é™¤æ–‡ä»¶ï¼Œdocker å®¹å™¨ä¸­èƒ½å³æ—¶çœ‹åˆ°æ–‡ä»¶å˜åŒ–ã€‚</p>
<p>Using bind mounts is common for local development setups. The advantage is that the development machine doesnâ€™t need to have all of the build tools and environments installed. With a single docker run command, Docker pulls dependencies and tools.</p>
<p>å°†æœ¬åœ°æºç æŒ‚è½½åˆ° Docker å¼€å‘ç¯å¢ƒä¸­ï¼š</p>
<pre><code class="sh">docker run -dp 127.0.0.1:3000:3000 \
-w /app \
--mount type=bind,src=&quot;$(pwd)&quot;,target=/app \
node:18-alpine \
sh c &quot;yarn install &amp;&amp; yarn run dev&quot;
</code></pre>
<p>-w: æŒ‡å®šæŒ‡å®šå®¹å™¨å·¥ä½œè·¯å¾„ã€‚</p>
<p>å½“æŒ‚è½½ç›®å½•æ–‡ä»¶æœ‰å˜åŒ–æ—¶ nodemon è¿›ç¨‹ä¼šè‡ªåŠ¨é‡å¯å®¹å™¨å†…åº”ç”¨ï¼Œä¿®æ”¹æºç å¯ä»¥åœ¨åº”ç”¨ä¸­å³ä½¿çœ‹åˆ°ã€‚</p>
<h2 id="å¤šå®¹å™¨åº”ç”¨"><a href="#å¤šå®¹å™¨åº”ç”¨" class="headerlink" title="å¤šå®¹å™¨åº”ç”¨"></a>å¤šå®¹å™¨åº”ç”¨</h2><h3 id="åˆ›å»º-æŸ¥çœ‹-åˆ é™¤-Docker-ç½‘ç»œ"><a href="#åˆ›å»º-æŸ¥çœ‹-åˆ é™¤-Docker-ç½‘ç»œ" class="headerlink" title="åˆ›å»º&#x2F;æŸ¥çœ‹&#x2F;åˆ é™¤ Docker ç½‘ç»œ"></a>åˆ›å»º&#x2F;æŸ¥çœ‹&#x2F;åˆ é™¤ Docker ç½‘ç»œ</h3><p>è€ƒè™‘åˆ°ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ã€ç»„ä»¶éš”ç¦»ã€é™ä½å®¹å™¨å¤æ‚åº¦ï¼Œæœ€å¥½åœ¨ä¸€ä¸ªå®¹å™¨ä¸­åªè¿è¡Œä¸€ä¸ªåº”ç”¨ã€‚å¤šä¸ªå®¹å™¨ä¹‹é—´é€šè¿‡ Docker ç½‘ç»œè¿›è¡Œé€šä¿¡ã€‚</p>
<p>åˆ›å»º Docker ç½‘ç»œ</p>
<pre><code class="sh">docker network create todo-app
</code></pre>
<p>æŸ¥çœ‹ Docker ç½‘ç»œ</p>
<pre><code class="sh">docker network ls
</code></pre>
<p>æŸ¥çœ‹å…·ä½“çš„ç½‘ç»œè¯¦æƒ…</p>
<pre><code class="sh">docker network inspect todo-app
</code></pre>
<p>åˆ é™¤ç½‘ç»œ</p>
<pre><code class="sh">docker network rm todo-app
</code></pre>
<p>å¯åŠ¨å®¹å™¨æ—¶åˆ›å»ºç½‘ç»œ</p>
<pre><code class="sh">docker run -d --network todo-app --network-alias mysql -v todo-mysql-data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=secret -e MYSQL_DATABASE=todos mysql
</code></pre>
<h3 id="nicolaka-netshoot"><a href="#nicolaka-netshoot" class="headerlink" title="nicolaka&#x2F;netshoot"></a>nicolaka&#x2F;netshoot</h3><p>nicolaka&#x2F;netshoot å®é™…ä¸Šæ˜¯ä¸€ä¸ªå·¥å…·é›†æä¾›äº†å¾ˆå¤šæ–¹ä¾¿çš„ç½‘ç»œé—®é¢˜è§£å†³å·¥å…·ï¼Œå¯ä»¥åŠ é€Ÿæˆ‘ä»¬å¯¹äºæ—¥å¸¸docker ä»¥åŠk8s ç½‘ç»œé—®é¢˜çš„è§£å†³ã€‚</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/nicolaka/netshoot">nicolaka&#x2F;netshoot - GitHub</a></p>
<p>è¿è¡Œ nicolaka&#x2F;netshoot å®¹å™¨</p>
<pre><code class="sh">docker run -it --network todo-app nicolaka/netshoot
</code></pre>
<p>ä½¿ç”¨ DNS å·¥å…· dig å‘½ä»¤æŸ¥çœ‹å…·ä½“å®¹å™¨çš„ç½‘ç»œä¿¡æ¯</p>
<pre><code class="sh">dig mysql
</code></pre>
<pre><code>; &lt;&lt;&gt;&gt; DiG 9.18.13 &lt;&lt;&gt;&gt; mysql
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 64589
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0

;; QUESTION SECTION:
;mysql.				IN	A

;; ANSWER SECTION:
mysql.			600	IN	A	172.18.0.2 # å®¹å™¨ IP

;; Query time: 16 msec
;; SERVER: 127.0.0.11#53(127.0.0.11) (UDP)
;; WHEN: Sun Sep 03 03:13:12 UTC 2023
;; MSG SIZE  rcvd: 44
</code></pre>
<p>å°†åº”ç”¨åŠ å…¥ç½‘ç»œ</p>
<pre><code class="sh">docker run -dp 0.0.0.0:3000:3000 -w /app --mount type=bind,src=&quot;$(pwd)&quot;,target=/app --network todo-app -e MYSQL_HOST=mysql -e MYSQL_USER=root -e MYSQL_PASSWORD=secret -e MYSQL_DB=todos node:18-alpine sh -c &quot;yarn install &amp;&amp; yarn run dev&quot;
</code></pre>
<h3 id="Docker-compose"><a href="#Docker-compose" class="headerlink" title="Docker compose"></a>Docker compose</h3><p>docker compose æ˜¯ä¸€ä¸ªç”¨ YAML æ–‡ä»¶æ¥å®šä¹‰å’Œåˆ†äº«å¤šå®¹å™¨åº”ç”¨çš„å·¥å…·ã€‚</p>
<p>å¯åŠ¨å•ä¸ªå®¹å™¨æ—¶</p>
<pre><code class="sh"># node
docker run -dp 0.0.0.0:3000:3000 -w /app -v &quot;$(pwd)&quot;:/app --network mysql -e MYSQL_HOST=mysql -e MYSQL_DB=todos -e MYSQL_USER=root -e MYSQL_PASSWORD=secret sh -c &quot;yarn install &amp;&amp; yarn run dev&quot; node:18-alpine

# mysql
docker run -d --network todo-app --network-alias mysql -v todo-mysql-data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=secret -e MYSQL_DB=todos mysql:8.0
</code></pre>
<p>åœ¨ compose.yaml æ–‡ä»¶ä¸­å®šä¹‰</p>
<pre><code class="yaml">services:
  app:
    image: node:18-alpine
    command: sh -c &quot;yarn install &amp;&amp; yarn run dev&quot;
    ports: 
      - 0.0.0.0:3000:3000
    working_dir: /app
    volumes:
      - ./:/app
    environment:
      MYSQL_DB: todos
      MYSQL_USER: root
      MYSQL_PASSWORD: secret
      MYSQL_HOST: mysql
  mysql:
    image: mysql:8.0
    volumes:
      - todo-mysql-data:/var/lib/mysql
    environment:
      MYSQL_ROOT_PASSWORD: secret
      MYSQL_DATABASE: todos
volumes:
  todo-mysql-data: 
</code></pre>
<p>æŒ‰ç…§ compose.yaml å®šä¹‰å¯åŠ¨å®¹å™¨ï¼ˆ<em>ä¸èƒ½æŒ‰ç…§ä¾èµ–å…³ç³»é¡ºåºå¯åŠ¨ï¼Œå¯èƒ½å¯¼è‡´éƒ¨åˆ†å®¹å™¨å¯åŠ¨å¤±è´¥</em>ï¼‰</p>
<pre><code class="sh">docker compose up -d
</code></pre>
<p>æŸ¥çœ‹æ—¥å¿—</p>
<pre><code class="sh">docker compose logs -f
</code></pre>
<p>docker ä¼šè‡ªåŠ¨åˆ›å»º network å’Œ volumeã€‚</p>
<p>åˆ é™¤ç›¸å…³çš„å®¹å™¨ï¼ˆä¸ä¼šåˆ é™¤åˆ›å»ºçš„ volumeï¼Œå¦‚æœè¦åˆ é™¤ volumeï¼Œéœ€è¦åŠ  â€“volumesï¼‰</p>
<pre><code class="sh">docker compose down --volumes
</code></pre>
<h2 id="é•œåƒæ„å»ºæœ€ä½³å®è·µ"><a href="#é•œåƒæ„å»ºæœ€ä½³å®è·µ" class="headerlink" title="é•œåƒæ„å»ºæœ€ä½³å®è·µ"></a>é•œåƒæ„å»ºæœ€ä½³å®è·µ</h2><h3 id="åªåƒé•œåƒä¸­å¤åˆ¶å¿…è¦çš„æ–‡ä»¶æœ‰åŠ©äºç¼©å°é•œåƒçš„å¤§å°"><a href="#åªåƒé•œåƒä¸­å¤åˆ¶å¿…è¦çš„æ–‡ä»¶æœ‰åŠ©äºç¼©å°é•œåƒçš„å¤§å°" class="headerlink" title="åªåƒé•œåƒä¸­å¤åˆ¶å¿…è¦çš„æ–‡ä»¶æœ‰åŠ©äºç¼©å°é•œåƒçš„å¤§å°"></a>åªåƒé•œåƒä¸­å¤åˆ¶å¿…è¦çš„æ–‡ä»¶æœ‰åŠ©äºç¼©å°é•œåƒçš„å¤§å°</h3><pre><code class="dockerfile"># syntax=docker/dockerfile:1
FROM node:18-alpine
WORKDIR /app
# ä»…å¤åˆ¶å¿…è¦çš„æ–‡ä»¶
COPY package.json yarn.lock ./
RUN yarn install --production
COPY . .
CMD [&quot;node&quot;, &quot;src/index.js&quot;]
</code></pre>
<p>å¯ä»¥ä½¿ç”¨ .dockerignore æ–‡ä»¶</p>
<h3 id="Multi-stage-builds"><a href="#Multi-stage-builds" class="headerlink" title="Multi-stage builds"></a>Multi-stage builds</h3><p>Multi-stage builds are an incredibly powerful tool to help use multiple stages to create an image. There are several advantages for them:</p>
<ul>
<li>Separate build-time dependencies from runtime dependencies</li>
<li>Reduce overall image size by shipping only what your app needs to run</li>
</ul>
<p>æ„å»º Maven&#x2F;Tomcat åº”ç”¨æ—¶ï¼Œåˆ†ç¦»ç¼–è¯‘æ–‡ä»¶å’Œè¿è¡Œæ—¶æ–‡ä»¶</p>
<pre><code class="dockerfile"># syntax=docker/dockerfile:1

FROM maven AS build
WORKDIR /app
COPY . .
RUN mvn package

FROM tomcat
COPY --from=build /app/target/file.war /usr/local/tomcat/webapps
</code></pre>
<p>åˆ†ä¸¤ä¸ªé˜¶æ®µæ„å»ºï¼Œbuild é˜¶æ®µæ‰“åŒ…ï¼Œç¬¬äºŒé˜¶æ®µå¤åˆ¶ç¬¬ä¸€é˜¶æ®µ build ä¸­éœ€è¦çš„æ–‡ä»¶ï¼Œæœ€ç»ˆçš„é•œåƒä¸­ä¸ä¼šåŒ…å« build é˜¶æ®µã€‚</p>
<h2 id="ç‰¹å®šåœºæ™¯æœ€ä½³å®è·µ"><a href="#ç‰¹å®šåœºæ™¯æœ€ä½³å®è·µ" class="headerlink" title="ç‰¹å®šåœºæ™¯æœ€ä½³å®è·µ"></a>ç‰¹å®šåœºæ™¯æœ€ä½³å®è·µ</h2><p><a target="_blank" rel="noopener" href="https://docs.docker.com/language/nodejs/">Node.js ä½¿ç”¨ Docker</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.docker.com/language/java/">Java ä½¿ç”¨ Docker</a></p>
<p>å‚è€ƒèµ„æ–™ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.docker.com/get-started/">Getting started - Docker</a></li>
<li><a href="%5Bhttps://cn.bing.com/search?q=docker%E5%AE%B9%E5%99%A8%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8&search=&form=QBLH&sp=-1&lq=0&pq=docker%E5%AE%B9%E5%99%A8%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8&sc=10-12&qs=n&sk=&cvid=EE8D6718F27C4A828C93F5E48222F419&ghsh=0&ghacc=0&ghpl=">Docker å¸¸ç”¨æ“ä½œ-çŸ¥ä¹</a></li>
</ul>

  </div>
</article>


    <div class="blog-post-comments">
        <div id="utterances_thread">
            <noscript>åŠ è½½è¯„è®ºéœ€è¦åœ¨æµè§ˆå™¨å¯ç”¨ JavaScript è„šæœ¬æ”¯æŒã€‚</noscript>
        </div>
    </div>


        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">é¦–é¡µ</a></li>
        
          <li><a href="/archives/">å½’æ¡£</a></li>
        
          <li><a href="/friends/">å‹é“¾</a></li>
        
          <li><a href="/about/">å…³äº</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://www.travellings.cn/go.html">å¼€å¾€ ğŸš‡</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0"><span class="toc-number">1.</span> <span class="toc-text">Docker å­¦ä¹ ç¬”è®°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Debian12-%E5%AE%89%E8%A3%85-Docker"><span class="toc-number">2.</span> <span class="toc-text">Debian12 å®‰è£… Docker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dockerfile-%E7%94%9F%E6%88%90%E9%95%9C%E5%83%8F"><span class="toc-number">3.</span> <span class="toc-text">Dockerfile ç”Ÿæˆé•œåƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-Hub-%E5%85%B1%E4%BA%AB%E9%95%9C%E5%83%8F"><span class="toc-number">4.</span> <span class="toc-text">Docker Hub å…±äº«é•œåƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DB-%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-number">5.</span> <span class="toc-text">DB æŒä¹…åŒ–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#volume-%E6%8C%81%E4%B9%85%E5%8C%96%E6%95%B0%E6%8D%AE"><span class="toc-number">5.1.</span> <span class="toc-text">volume æŒä¹…åŒ–æ•°æ®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bind-%E6%8C%81%E4%B9%85%E5%8C%96%E6%95%B0%E6%8D%AE"><span class="toc-number">5.2.</span> <span class="toc-text">bind æŒä¹…åŒ–æ•°æ®</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E5%AE%B9%E5%99%A8%E5%BA%94%E7%94%A8"><span class="toc-number">6.</span> <span class="toc-text">å¤šå®¹å™¨åº”ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-%E6%9F%A5%E7%9C%8B-%E5%88%A0%E9%99%A4-Docker-%E7%BD%91%E7%BB%9C"><span class="toc-number">6.1.</span> <span class="toc-text">åˆ›å»º&#x2F;æŸ¥çœ‹&#x2F;åˆ é™¤ Docker ç½‘ç»œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nicolaka-netshoot"><span class="toc-number">6.2.</span> <span class="toc-text">nicolaka&#x2F;netshoot</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Docker-compose"><span class="toc-number">6.3.</span> <span class="toc-text">Docker compose</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%95%9C%E5%83%8F%E6%9E%84%E5%BB%BA%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">7.</span> <span class="toc-text">é•œåƒæ„å»ºæœ€ä½³å®è·µ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AA%E5%83%8F%E9%95%9C%E5%83%8F%E4%B8%AD%E5%A4%8D%E5%88%B6%E5%BF%85%E8%A6%81%E7%9A%84%E6%96%87%E4%BB%B6%E6%9C%89%E5%8A%A9%E4%BA%8E%E7%BC%A9%E5%B0%8F%E9%95%9C%E5%83%8F%E7%9A%84%E5%A4%A7%E5%B0%8F"><span class="toc-number">7.1.</span> <span class="toc-text">åªåƒé•œåƒä¸­å¤åˆ¶å¿…è¦çš„æ–‡ä»¶æœ‰åŠ©äºç¼©å°é•œåƒçš„å¤§å°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Multi-stage-builds"><span class="toc-number">7.2.</span> <span class="toc-text">Multi-stage builds</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E5%AE%9A%E5%9C%BA%E6%99%AF%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">8.</span> <span class="toc-text">ç‰¹å®šåœºæ™¯æœ€ä½³å®è·µ</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://lozhu.happy365.day/2023/09/02/5157cf948645/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li> -->
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://lozhu.happy365.day/2023/09/02/5157cf948645/&text=Dockerå­¦ä¹ ç¬”è®°"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://lozhu.happy365.day/2023/09/02/5157cf948645/&title=Dockerå­¦ä¹ ç¬”è®°"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://lozhu.happy365.day/2023/09/02/5157cf948645/&is_video=false&description=Dockerå­¦ä¹ ç¬”è®°"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li> -->
  <li><a class="icon" href="mailto:?subject=Dockerå­¦ä¹ ç¬”è®°&body=Check out this article: https://lozhu.happy365.day/2023/09/02/5157cf948645/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://lozhu.happy365.day/2023/09/02/5157cf948645/&title=Dockerå­¦ä¹ ç¬”è®°"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://lozhu.happy365.day/2023/09/02/5157cf948645/&title=Dockerå­¦ä¹ ç¬”è®°"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://lozhu.happy365.day/2023/09/02/5157cf948645/&title=Dockerå­¦ä¹ ç¬”è®°"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://lozhu.happy365.day/2023/09/02/5157cf948645/&title=Dockerå­¦ä¹ ç¬”è®°"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://lozhu.happy365.day/2023/09/02/5157cf948645/&name=Dockerå­¦ä¹ ç¬”è®°&description=&lt;h2 id=&#34;Docker-å­¦ä¹ ç¬”è®°&#34;&gt;&lt;a href=&#34;#Docker-å­¦ä¹ ç¬”è®°&#34; class=&#34;headerlink&#34; title=&#34;Docker å­¦ä¹ ç¬”è®°&#34;&gt;&lt;/a&gt;Docker å­¦ä¹ ç¬”è®°&lt;/h2&gt;&lt;p&gt;Docker æ˜¯ä¸€ä¸ªä¸ºå¼€å‘ã€åˆ†å‘ã€è¿è¡Œåº”ç”¨ç¨‹åºè€Œç”Ÿçš„å¼€æ”¾å¹³å°ï¼ŒDocker å¯ä»¥è®©æˆ‘ä»¬å°†åŸºç¡€ç¯å¢ƒå’Œåº”ç”¨ç¨‹åºåˆ†ç¦»å¼€æ¥ï¼Œä»¥ä¾¿å¯ä»¥å¿«é€Ÿäº¤ä»˜è½¯ä»¶ã€‚æœ‰äº† Dockerï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç®¡ç†è½¯ä»¶çš„åŒæ—¶ç®¡ç†åŸºç¡€ç¯å¢ƒã€‚åŸºäº Docker åˆ†å‘ã€æµ‹è¯•ã€éƒ¨ç½²çš„æ–¹æ³•è®ºï¼Œå¯ä»¥æå¤§çš„é™ä½ç¼–ç ä¸äº¤ä»˜è¿è¡Œä¹‹é—´çš„å»¶è¿Ÿã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ Docker å¯ä»¥å¾ˆè½»æ¾çš„ä¿è¯ç¨‹åºè¿è¡Œç¯å¢ƒçš„ä¸€è‡´æ€§ï¼Œå‡å°‘å› ç¯å¢ƒä¸ä¸€è‡´å¯¼è‡´çš„å„ç§é—®é¢˜ã€‚å„ä¸ª Docker å®¹å™¨ä¹‹é—´ç›¸äº’éš”ç¦»ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªå®¿ä¸»æœºä¸Šè¿è¡Œå¤šä¸ªå®¹å™¨ï¼Œå„ä¸ªå®¹å™¨éƒ½åŒ…å«äº†åº”ç”¨ç¨‹åºéœ€è¦çš„æ‰€æœ‰èµ„æºï¼Œå¯ä»¥å¾ˆè½»æ¾çš„ä¿è¯åŒä¸€ä¸ªå®¹å™¨åœ¨æ¯ä¸ªåœ°æ–¹è¿è¡Œçš„ç»“æœéƒ½ä¸€è‡´ã€‚&lt;/p&gt;"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li> -->
  <!-- <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://lozhu.happy365.day/2023/09/02/5157cf948645/&t=Dockerå­¦ä¹ ç¬”è®°"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li> -->
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> èœå•</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> ç›®å½•</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> åˆ†äº«</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> è¿”å›é¡¶éƒ¨</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    <!-- Copyright --> &copy;
    
    
    2018-2024
    lozhu
  </div>
  
    <div>
      <a href="https://icp.gov.moe/?keyword=20249900" target="_blank">èŒICPå¤‡ 20249900 å·</a>
    </div>
  
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">é¦–é¡µ</a></li><!--
     --><!--
       --><li><a href="/archives/">å½’æ¡£</a></li><!--
     --><!--
       --><li><a href="/friends/">å‹é“¾</a></li><!--
     --><!--
       --><li><a href="/about/">å…³äº</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://www.travellings.cn/go.html">å¼€å¾€ ğŸš‡</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"å¤åˆ¶åˆ°ç²˜è´´æ¿ï¼\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "å¤åˆ¶æˆåŠŸï¼");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

  <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?8bdf047ae0a66729bd3b27e8bb56fe11";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
      </script>

<!-- 51la Analytics -->

  <script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
  <script>
  LA.init({
      id: '3I0QIERSX42bDzDc',
      ck: '3I0QIERSX42bDzDc'
  })
  </script>

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

    <script type="text/javascript">
      var utterances_repo = 'lozhu20/my-blog-comments';
      var utterances_issue_term = 'pathname';
      var utterances_label = 'Comment';
      var utterances_theme = 'github-light';

      (function(){
          var script = document.createElement('script');

          script.src = 'https://utteranc.es/client.js';
          script.setAttribute('repo', utterances_repo);
          script.setAttribute('issue-term', 'pathname');
          script.setAttribute('label', utterances_label);
          script.setAttribute('theme', utterances_theme);
          script.setAttribute('crossorigin', 'anonymous');
          script.async = true;
          (document.getElementById('utterances_thread')).appendChild(script);
      }());
  </script>

<!-- image modal -->
<script>
  (function() {
    var contentNode = document.getElementsByClassName('content e-content');
    if (!contentNode || contentNode.length === 0) {
      console.log('no content, exit');
      return;
    }

    var imgsNodes = contentNode[0].getElementsByTagName('img');
    if (!imgsNodes || imgsNodes.length === 0) {
      console.log('no image, exit');
      return;
    }

    var span = document.getElementById('modal_close_btn');
    span.onclick = function() { 
      modal.style.display = "none";
    };

    var modal = document.getElementById('modal');
    var modalImage = document.getElementById('modal_image');
    var captionText = document.getElementById('caption');

    for (var i = imgsNodes.length - 1; i >= 0; i--) {
      let image = imgsNodes[i];
      image.onclick = function() {
        modal.style.display = "block";
        modalImage.src = this.src;
        captionText.innerHTML = this.alt || "æ–‡ç« é…å›¾";
      };
    }
  }());
</script>

</body>
</html>
